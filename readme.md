# Метрические алгоритмы классификации

## K ближайших соседей (KNN)

Используется метрический алгоритм классификации KNN. В задаче используется выборка, содержащая 150 объектов-ирисов:
по 50 объектов каждого из трёх классов. В задаче требуется определить класс любого объекта.

Решение:
1. Сортируется выборка по расстоянию.
2. Используется метод KNN который: возвращает класс чаще всего встречается среди k ближайших соседей.
3. Используется метод LOO который определят оптимальное значение k. 
Для этого убирается первый объект выборки, и запускаем KNN для отсальных. 
Далее сравнивается класс первого объекта который получился и истиный класс этого же объекта, если они не совпадают, 
то сумма ошибок увеличивается на 1. 
Проделаваются эти же самые действия для всех остальных объектов выборки тем самым накапливая сумму погрешности. 
Далее накопливаемая сумма делится на количество объектов выборки. 
LOO применяется для каждого k, и то k для которого усредненная ошибка минимально и будет наше оптимальное k.
4. Рисуется выборка.
5. Рисуются классифицируемые объекты.

### Функция расчета KNN
    KNN <- function(xl, z, k) {	  
		#возвращает класс объекта который чаще всего встречается
		orderedXl <- sort_ojects_by_dist(xl, z)     
		n <- dim(orderedXl)[2] - 1 
		classes <- orderedXl[1:k, n + 1] 
		counts <- table(classes) 
		class <- names(which.max(counts)) 
		return (class)	  
	}
	
###	График классификации 
![](https://github.com/PavlovaJulia/R_Projects/blob/master/lab2/KNN.png)